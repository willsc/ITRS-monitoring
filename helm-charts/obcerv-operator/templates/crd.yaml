{{- if .Values.installCRDs }}
#
# IMPORTANT:  When copying new CRD here, be sure to maintain the Helm annotations and templating:
#
# metadata:
#   annotations:
#     "helm.sh/resource-policy": "keep"
---
apiVersion: "apiextensions.k8s.io/v1"
kind: "CustomResourceDefinition"
metadata:
  name: "obcervs.itrsgroup.com"
  annotations:
    "helm.sh/resource-policy": "keep"  
spec:
  group: "itrsgroup.com"
  names:
    kind: "Obcerv"
    listKind: "ObcervList"
    plural: "obcervs"
    singular: "obcerv"
  scope: "Namespaced"
  versions:
  - name: "v1"
    served: true
    storage: true
    subresources:
      status: {}
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              apps:
                properties:
                  externalHostname:
                    type: string
                  ingress:
                    properties:
                      annotations:
                        additionalProperties:
                          type: string
                        type: object
                      path:
                        type: string
                      pathType:
                        type: string
                      tlsSecret:
                        type: string
                    type: object
                type: object
              collection:
                properties:
                  daemonSet:
                    properties:
                      logLevel:
                        type: string
                      loggers:
                        items:
                          type: string
                        type: array
                      nodeSelector:
                        additionalProperties:
                          type: string
                        type: object
                      resources:
                        properties:
                          limits:
                            additionalProperties:
                              type: string
                            type: object
                          requests:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      tolerations:
                        items:
                          properties:
                            effect:
                              type: string
                            key:
                              type: string
                            operator:
                              type: string
                            tolerationSeconds:
                              type: integer
                            value:
                              type: string
                          type: object
                        type: array
                    type: object
                  dimensionExcludes:
                    items:
                      type: string
                    type: array
                  image:
                    type: string
                  logs:
                    properties:
                      enabled:
                        type: boolean
                      namespaces:
                        items:
                          type: string
                        type: array
                    type: object
                  metrics:
                    properties:
                      aws:
                        properties:
                          enabled:
                            type: boolean
                          intervalMillis:
                            type: integer
                          region:
                            type: string
                          secret:
                            type: string
                        type: object
                      jvmOpts:
                        type: string
                      logLevel:
                        type: string
                      namespaces:
                        items:
                          type: string
                        type: array
                      resources:
                        properties:
                          limits:
                            additionalProperties:
                              type: string
                            type: object
                          requests:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      scrapePort:
                        type: integer
                      statsdPort:
                        type: integer
                      statsdProtocol:
                        type: string
                    type: object
                type: object
              defaultImagePullPolicy:
                type: string
              defaultStorageClass:
                type: string
              disablePostInstallCleanup:
                type: boolean
              disableServiceSecurity:
                type: boolean
              docker:
                properties:
                  registry:
                    type: string
                  secret:
                    type: string
                type: object
              downsampledMetricsStream:
                properties:
                  bucketedDiskSize:
                    type: string
                  bucketedReplicas:
                    type: integer
                  bucketedResources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  bucketedRocksdb:
                    properties:
                      blockSize:
                        type: integer
                      indexFilterRatio:
                        type: number
                      totalMemTableMemory:
                        type: integer
                      totalOffHeapMemory:
                        type: integer
                      writeBufferSize:
                        type: integer
                    type: object
                  bucketedThreads:
                    type: integer
                  diskSize:
                    type: string
                  image:
                    type: string
                  logLevel:
                    type: string
                  maxPollRecords:
                    type: integer
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  rawRocksdb:
                    properties:
                      blockSize:
                        type: integer
                      indexFilterRatio:
                        type: number
                      totalMemTableMemory:
                        type: integer
                      totalOffHeapMemory:
                        type: integer
                      writeBufferSize:
                        type: integer
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  storageClass:
                    type: string
                  storeRetention:
                    properties:
                      metrics12h:
                        type: integer
                      metrics15m:
                        type: integer
                      metrics1d:
                        type: integer
                      metrics1h:
                        type: integer
                      metrics3h:
                        type: integer
                      metrics5m:
                        type: integer
                      statuses:
                        type: integer
                    type: object
                  threads:
                    type: integer
                type: object
              dpd:
                properties:
                  entitiesInMemoryCacheSizeMb:
                    type: integer
                  image:
                    type: string
                  jvmOpts:
                    type: string
                  kafkaConsumerMaxPollRecords:
                    type: integer
                  logLevel:
                    type: string
                  metricsMultiplexer:
                    properties:
                      localParallelism:
                        type: integer
                      maxConcurrentOps:
                        type: integer
                      maxFilterResultCacheSize:
                        type: integer
                    type: object
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  selfMonitoringThresholds:
                    additionalProperties:
                      type: integer
                    type: object
                  shutdownGracePeriodSeconds:
                    type: integer
                type: object
              entityEvictions:
                properties:
                  cron:
                    type: string
                  deleteEvictedEntitiesAfter:
                    type: string
                  deleteEvictedEntitiesEvery:
                    type: string
                  evictionRules:
                    items:
                      properties:
                        attribute:
                          properties:
                            name:
                              type: string
                            namespace:
                              type: string
                          type: object
                        expiration:
                          type: string
                      type: object
                    type: array
                  image:
                    type: string
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                type: object
              entityStream:
                properties:
                  final:
                    properties:
                      containmentRulesBatchTimeoutMillis:
                        type: integer
                      enrichmentRulesetBatchTimeoutMillis:
                        type: integer
                      entitySerdeCacheSize:
                        type: integer
                      entityStatisticsPeriodicitySeconds:
                        type: integer
                      image:
                        type: string
                      jvmOpts:
                        type: string
                      logLevel:
                        type: string
                      resources:
                        properties:
                          limits:
                            additionalProperties:
                              type: string
                            type: object
                          requests:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      rocksdb:
                        properties:
                          enableStats:
                            type: boolean
                          indexAndFilterRatio:
                            type: number
                          memoryMib:
                            type: integer
                          writeBufferMib:
                            type: integer
                          writeBufferRatio:
                            type: number
                        type: object
                    type: object
                  intermediate:
                    properties:
                      image:
                        type: string
                      jvmOpts:
                        type: string
                      logLevel:
                        type: string
                      replicas:
                        type: integer
                      resources:
                        properties:
                          limits:
                            additionalProperties:
                              type: string
                            type: object
                          requests:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      rocksdb:
                        properties:
                          enableStats:
                            type: boolean
                          indexAndFilterRatio:
                            type: number
                          memoryMib:
                            type: integer
                          writeBufferMib:
                            type: integer
                          writeBufferRatio:
                            type: number
                        type: object
                      signalThresholds:
                        additionalProperties:
                          type: integer
                        type: object
                    type: object
                type: object
              etcd:
                properties:
                  autoCompactionRetention:
                    type: integer
                  diskSize:
                    type: string
                  image:
                    type: string
                  logLevel:
                    type: string
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  quotaBackendBytes:
                    type: integer
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  snapshotCount:
                    type: integer
                  storageClass:
                    type: string
                  tolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                type: object
              iam:
                properties:
                  ingress:
                    properties:
                      annotations:
                        additionalProperties:
                          type: string
                        type: object
                      path:
                        type: string
                      pathType:
                        type: string
                      tlsSecret:
                        type: string
                    type: object
                  keycloak:
                    properties:
                      databaseName:
                        type: string
                      image:
                        type: string
                      logLevel:
                        type: string
                      resources:
                        properties:
                          limits:
                            additionalProperties:
                              type: string
                            type: object
                          requests:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      serviceAnnotations:
                        additionalProperties:
                          type: string
                        type: object
                      serviceType:
                        type: string
                    type: object
                  toolsImage:
                    type: string
                type: object
              ingestion:
                properties:
                  externalHostname:
                    type: string
                  ingress:
                    properties:
                      annotations:
                        additionalProperties:
                          type: string
                        type: object
                      path:
                        type: string
                      pathType:
                        type: string
                      tlsSecret:
                        type: string
                    type: object
                  internalEnabled:
                    type: boolean
                  logLevel:
                    type: string
                  op5:
                    properties:
                      enabled:
                        type: boolean
                      replicas:
                        type: integer
                      resources:
                        properties:
                          limits:
                            additionalProperties:
                              type: string
                            type: object
                          requests:
                            additionalProperties:
                              type: string
                            type: object
                        type: object
                      serviceAnnotations:
                        additionalProperties:
                          type: string
                        type: object
                      servicePort:
                        type: integer
                      serviceType:
                        type: string
                    type: object
                  otelEnabled:
                    type: boolean
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  serviceAnnotations:
                    additionalProperties:
                      type: string
                    type: object
                  serviceType:
                    type: string
                type: object
              kafka:
                properties:
                  brokerPort:
                    type: integer
                  clientPort:
                    type: integer
                  consumer:
                    properties:
                      fetchMaxWaitMs:
                        type: integer
                      fetchMinBytes:
                        type: integer
                    type: object
                  dataVersion:
                    type: string
                  defaultChangelogTopicSegmentBytes:
                    type: integer
                  defaultLogSegmentBytes:
                    type: integer
                  defaultMessageMaxBytes:
                    type: integer
                  defaultPartitions:
                    type: integer
                  defaultRetentionMillis:
                    type: integer
                  diskSize:
                    type: string
                  heapOpts:
                    type: string
                  image:
                    type: string
                  logLevel:
                    type: string
                  metricsScrapePort:
                    type: integer
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  producer:
                    properties:
                      batchSize:
                        type: integer
                      bufferMemory:
                        type: integer
                      compressionType:
                        type: string
                      lingerMs:
                        type: integer
                      maxRequestSize:
                        type: integer
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  storageClass:
                    type: string
                  tolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                type: object
              kvStore:
                properties:
                  logLevel:
                    type: string
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  versionHistoryLimit:
                    type: integer
                type: object
              licenced:
                properties:
                  image:
                    type: string
                  logLevel:
                    type: string
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                type: object
              loki:
                properties:
                  diskSize:
                    type: string
                  image:
                    type: string
                  ingestionBurstSize:
                    type: integer
                  ingestionRateLimit:
                    type: integer
                  logLevel:
                    type: string
                  maxPayloadSize:
                    type: integer
                  maxStreamsPerUser:
                    type: integer
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  retentionTime:
                    type: string
                  storageClass:
                    type: string
                type: object
              mesh:
                properties:
                  resourcesHot:
                    additionalProperties:
                      type: string
                    type: object
                  resourcesStandard:
                    additionalProperties:
                      type: string
                    type: object
                type: object
              metricForecastd:
                properties:
                  image:
                    type: string
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                type: object
              platformImageTag:
                type: string
              platformd:
                properties:
                  entityQueryFetchSize:
                    type: integer
                  entityUtilityImage:
                    type: string
                  image:
                    type: string
                  jvmOpts:
                    type: string
                  logLevel:
                    type: string
                  metricQueryFetchSize:
                    type: integer
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  signalsChangelogStoreDir:
                    type: string
                type: object
              signalsStream:
                properties:
                  image:
                    type: string
                  logLevel:
                    type: string
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  rocksdb:
                    properties:
                      enableStats:
                        type: boolean
                      indexAndFilterRatio:
                        type: number
                      memoryMib:
                        type: integer
                      writeBufferMib:
                        type: integer
                      writeBufferRatio:
                        type: number
                    type: object
                type: object
              sinkd:
                properties:
                  entityCacheMaxSize:
                    type: integer
                  image:
                    type: string
                  jvmOpts:
                    type: string
                  logLevel:
                    type: string
                  loki:
                    properties:
                      maxPollRecords:
                        type: integer
                    type: object
                  metrics:
                    properties:
                      maxPollRecords:
                        type: integer
                    type: object
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  rawJvmOpts:
                    type: string
                  rawNodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  rawReplicas:
                    type: integer
                  rawResources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  timeseriesCacheMaxSize:
                    type: integer
                type: object
              timescale:
                properties:
                  clusterSize:
                    type: integer
                  compressAfter:
                    type: string
                  dataDiskSize:
                    type: string
                  dataStorageClass:
                    type: string
                  databaseName:
                    type: string
                  image:
                    type: string
                  maxConnections:
                    type: integer
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  pgExporterImage:
                    type: string
                  pgMajorVersion:
                    type: integer
                  pljavaJvmOptions:
                    type: string
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  retention:
                    properties:
                      entity_attributes:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics_12h:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics_15m:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics_1d:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics_1h:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics_3h:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      metrics_5m:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                      statuses:
                        properties:
                          chunkSize:
                            type: string
                          retention:
                            type: string
                        type: object
                    type: object
                  sharedBuffersPercentage:
                    type: integer
                  timeseriesDiskCount:
                    type: integer
                  timeseriesDiskSize:
                    type: string
                  timeseriesStorageClass:
                    type: string
                  tolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  walDiskSize:
                    type: string
                  walStorageClass:
                    type: string
                type: object
              tls:
                properties:
                  external:
                    properties:
                      selfSigned:
                        type: boolean
                    type: object
                  internal:
                    properties:
                      enabled:
                        type: boolean
                    type: object
                type: object
              topics:
                properties:
                  attributes:
                    type: string
                  downsampledMetricsPrefix:
                    type: string
                  entities:
                    type: string
                  entitiesToEvict:
                    type: string
                  entityAttributeUpdates:
                    type: string
                  entityContainmentRules:
                    type: string
                  entityEnrichmentRulesets:
                    type: string
                  events:
                    type: string
                  evictedEntities:
                    type: string
                  intermediateEntities:
                    type: string
                  logs:
                    type: string
                  metrics:
                    type: string
                  pipelineTaskRegistryChangelog:
                    type: string
                  signals:
                    type: string
                  signalsChangelog:
                    type: string
                  statusMetricUpdates:
                    type: string
                type: object
              version:
                type: string
              zookeeper:
                properties:
                  diskSize:
                    type: string
                  image:
                    type: string
                  jvmHeap:
                    type: string
                  logLevel:
                    type: string
                  nodeSelector:
                    additionalProperties:
                      type: string
                    type: object
                  replicas:
                    type: integer
                  resources:
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        type: object
                    type: object
                  storageClass:
                    type: string
                type: object
            type: object
          status:
            properties:
              reason:
                type: string
              status:
                enum:
                - CREATED
                - DEPLOYING
                - DEPLOYED
                - DELETING
                - FAILED
                type: string
            type: object
        type: object
{{- end }}
